<div class="patients-container">
  <!-- Header -->
  <header class="header">
    <div class="logo-container">
      <img src="assets/images/logo-oncontigo.png" alt="OnContigo Logo" class="logo">
    </div>
    <h1 class="title">LISTA DE PACIENTES</h1>
  </header>

  <div class="content">
    <div class="table-container">
      <table class="patients-table">
        <thead>
        <tr>
          <th>Foto</th>
          <th>DNI</th>
          <th>Nombre completo</th>
          <th>Ãšlt. Cita</th>
          <th>Prox. Cita</th>
          <th>Alarma</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let patient of patients; let i = index" [ngClass]="{'odd-row': i % 2 !== 0}">
          <td class="photo-cell">
            <div class="patient-photo">
              <img *ngIf="patient.photoUrl" [src]="patient.photoUrl" alt="Foto de paciente">
            </div>
          </td>
          <td>{{ patient.dni }}</td>
          <td>{{ patient.name }}</td>
          <td>{{ patient.lastAppointment }}</td>
          <td>{{ patient.nextAppointment }}</td>
          <td class="alert-cell">
            <button class="alert-icon" *ngIf="patient.hasAlert" (click)="openAlarmModal(patient)">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
              </svg>
            </button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <div class="actions-panel">
      <button class="action-button add-button" (click)="addPatient()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        Agregar Paciente
      </button>

      <button class="action-button details-button" (click)="viewDetails(0)">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="21" y1="10" x2="3" y2="10"></line>
          <line x1="21" y1="6" x2="3" y2="6"></line>
          <line x1="21" y1="14" x2="3" y2="14"></line>
          <line x1="21" y1="18" x2="3" y2="18"></line>
        </svg>
        Ver detalles
      </button>

      <button class="action-button prescribe-button" (click)="prescribeMedication(0)">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path>
          <line x1="9" y1="9" x2="15" y2="9"></line>
          <line x1="9" y1="12" x2="15" y2="12"></line>
          <line x1="9" y1="15" x2="13" y2="15"></line>
        </svg>
        Recetar Medicamento
      </button>

      <button class="action-button delete-button" (click)="deletePatient(0)">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="15" y1="9" x2="9" y2="15"></line>
          <line x1="9" y1="9" x2="15" y2="15"></line>
        </svg>
        Eliminar Paciente
      </button>
    </div>
  </div>

  <!-- Modal de Alarma -->
  <div class="modal-overlay" *ngIf="showAlarmModal">
    <div class="alarm-modal">
      <h2 class="modal-title">Alarma paciente</h2>

      <div class="modal-content">
        <div class="patient-info">
          <div class="info-row">
            <span class="info-label">Nombre completo:</span>
            <span class="info-value">{{ selectedAlarm.patientName }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">DNI:</span>
            <span class="info-value">{{ selectedAlarm.patientDni }}</span>
          </div>
        </div>

        <div class="time-selector">
          <span class="time-label">Asigna la hora:</span>

          <div class="time-inputs">
            <!-- Selector de horas -->
            <div class="time-input-container">
              <button class="time-arrow up" (click)="incrementHours()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="18 15 12 9 6 15"></polyline>
                </svg>
              </button>
              <input type="text" class="time-input" [(ngModel)]="selectedAlarm.hours" readonly>
              <button class="time-arrow down" (click)="decrementHours()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </button>
            </div>

            <!-- Separador -->
            <div class="time-separator">
              <div class="dot"></div>
              <div class="dot"></div>
            </div>

            <!-- Selector de minutos -->
            <div class="time-input-container">
              <button class="time-arrow up" (click)="incrementMinutes()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="18 15 12 9 6 15"></polyline>
                </svg>
              </button>
              <input type="text" class="time-input" [(ngModel)]="selectedAlarm.minutes" readonly>
              <button class="time-arrow down" (click)="decrementMinutes()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <div class="note-container">
          <span class="note-label">Nota:</span>
          <textarea class="note-input" [(ngModel)]="selectedAlarm.note" placeholder="Escribe una nota..."></textarea>
        </div>
      </div>

      <div class="modal-actions">
        <button class="modal-button cancel" (click)="closeAlarmModal()">Cancelar</button>
        <button class="modal-button confirm" (click)="saveAlarm()">Ok</button>
      </div>
    </div>
  </div>
</div>
